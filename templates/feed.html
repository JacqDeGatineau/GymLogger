<!DOCTYPE html>

<html>
<head>
    <title>Body Dysmorphia Feed</title>
    <link rel="stylesheet" href="/static/main.css">
</head>

<body>
    <div class="container">
    <h1>Body Dysmorphia Feed</h1>

    <h3 style="margin-bottom: 40px; text-align: center;">Place to add images of yourself <br/> and comment on others to feel worse about yourself</h3>

    {% for post in feed %}
        <div style="border: 1px solid black; padding: 10px; margin-bottom: 10px;">
            <p><strong>Posted at:</strong> {{ post.time }} by <strong>{{ post.username }}</strong></p>
            {% if post.image %}
                <img src="/image/{{ post.id }}" alt="Image" style="max-width: 300px;"><br>
            {% endif %}
            {% if post.caption %}
                <p> {{ post.caption }}</p>
            {% endif %}
        </div>
        
        
        <div style="margin-top: 15px; align-items: left;">
            <strong>Comments:</strong>
            {% if post.comments %}
                {% for comment in post.comments %}
                    <div>
                        <strong>{{ comment.username }}:</strong> {{ comment.comment | show_lines }}
                        <small style="color: gray;">{{ comment.time }}</small>
                    </div>
                {% endfor %}
            {% else %}
                <p style="color: gray;">No-one cares</p>
            {% endif %}
        
        <hr/>

        <form action="add_comment" method="POST">
            <input type="hidden" name="feed_id" value="{{ post.id }}">
            <textarea name="comment" class="input" rows="3" cols="28" placeholder="Add a comment" required></textarea>
            <button class="button" type="submit">Post Comment</button>
        </form>
        
        <hr>
        </div>

    {% else %}
        <p>No posts available.</p>
    {% endfor %}

    <form action="/add_image" method="POST" enctype="multipart/form-data">
        <p>
            Image: <input type="file" name="image" accept=".jpg" />
        </p>
        <p>
            Caption: <input type="text" class="input" name="caption" />
        </p>
        <input type="submit" class="button" value="Lähetä" />
    </form>
    <br/>
    <a href="/" class="form">
        <button class="button">Home</button>
    </a>
    </div>
</body>
</html>